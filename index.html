<html>
<head>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<!-- Load the d3 library. -->
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<style>
/* put a border around the svg element so we can see the coordinate system better. */
body { font-family: "Open Sans"; } div { margin: 30px; }
svg { border: solid black 1px; }
circle { opacity: 0.3; }
</style>
</head>
<body>
<h1>Project One</h1>

<!-- The SVG element will go in here -->
<div id="visualization">
</div>

<script>
// width and height of the SVG element - I just added some numbers, feel free to change it
var width = 500,
    height = 500;

var paymentData;

// start of d3 code - note, I pulled this set up from the 2/18 class prompt notes - I think that prompt will be most relevant for us

d3.csv("General_Payment_Data_with_Identifying_Recipient_Information___Detailed_Dataset_2013_Reporting_YearUSA.csv", function (error, data) { 
	paymentData = data;
	
	// The column in the CVS file that has the NUMBER of physicians paid per pharma company is: Physician_Profile_ID

	// The column in the CVS file that has the SUM (dollars) of payments for all physicians per pharma company is: Total_Amount_of_Payment_USDollars
	
	// The column in the CVS file that has the NAME of the pharma company is: Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Name
	
	//adding an svg element in the "visualization" div:
var svg = d3.select("#visualization").append("svg")
	.attr("width", width)
	.attr("height", height);	
	
	// end of D3 code
	
	});
	

//Accessing the data about the payment and stripping the "$"

// This should be working, but it's throwing up an error.
//For some reason, it doesn't let me work with paymentData and
//its properties, yet this whole thing works in the console.

var paymentDataStrip = [];

for(var i = 0; i < paymentData.length; i++) {

paymentDataStrip[i]=paymentData[i].Total_Amount_of_Payment_USDollars.substr(1, paymentData[i].Total_Amount_of_Payment_USDollars.length );
console.log(paymentDataStrip[i]); 
}



// Eventually radii will be the number values of the
//payment amounts.
var radii = [10, 20, 30, 40];
// example, = paymentDataStrip;

function makeCircle(r,i){
	var svg1 = d3.select("svg");
	var circle = svg1.append("circle");
	circle
	.attr("cx", i*60 + 10)
		.attr("cy", 150)
		.attr("r", r);
// Note that I'm setting a position for cx and cy. Once we
//get xScale and yScale working, we should replace those
// with the correct position values for each circle.
// Most likely, we will use a nested function
};

// This function call should be working, but it isn't.
//Works on the console. Why... what... It should make circles appear
radii.forEach(makeCircle);



</script>

</body>
</html>